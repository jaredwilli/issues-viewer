"use strict";angular.module("issuesViewer",["ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{issues:["issuesService",function(a){return a.list()}],totalResults:["issuesService",function(a){return a.getAll()}]}}).when("/issue/:id",{templateUrl:"views/issue.html",controller:"IssueCtrl",resolve:{issues:["$location","issuesService",function(a,b){return b.get(a.path().split("/issue/")[1])}],comments:["$location","issuesService",function(a,b){return b.getComments(a.path().split("/issue/")[1])}]}}).otherwise({redirectTo:"/"})}]),angular.module("issuesViewer").controller("MainCtrl",["$scope","$location","issuesService","issues","totalResults","trimIssues",function(a,b,c,d,e,f){a.repo="rails/rails",a.issues=d.data,f.trim(a.issues),a.paging={},a.paging.startIndex=1,a.paging.endIndex=30,a.paging.perPage=30,a.paging.totalCount=e.data.length,a.paging.totalPages=Math.ceil(a.paging.totalCount/a.paging.perPage),a.paging.firstPage=1,a.paging.lastPage=a.paging.totalPages,a.paging.currentPage=1,a.paging.prevPage=a.paging.currentPage-1,a.paging.nextPage=a.paging.currentPage+1,a.getRepo=function(){c.list(1,30,a.repo).success(function(b){a.issues=b,f.trim(a.issues)}),c.getAll(a.reop).success(function(b){a.totalCount=b.length})},a.movePage=function(b){a.paging.currentPage=b,a.paging.startIndex=(b-1)*a.paging.perPage+1,a.paging.endIndex=Math.min(a.paging.totalCount,a.paging.perPage*b),c.list(b).success(function(b){a.issues=b,f.trim(a.issues)})},a.prevPage=function(){a.movePage(a.paging.currentPage-1)},a.nextPage=function(){a.movePage(a.paging.currentPage+1)},a.range=function(a){for(var b=[],c=1;a>=c;++c)b.push(c);return b}}]).service("trimIssues",function(){this.trim=function(a){return a.forEach(function(a){var b=a.title.substr(0,140);return a.title=b.substr(0,Math.min(b.length,b.lastIndexOf(" ")))+"...",a})}}),angular.module("issuesViewer").controller("IssueCtrl",["$scope","issues","comments",function(a,b,c){a.issue=b.data,a.comments=c.data}]),angular.module("issuesViewer").service("issuesService",["$http",function(a){var b="https://api.github.com/repos/",c="rails/rails";this.list=function(d,e,f){return e=e||30,d=d||1,f=f||c,a.get(b+f+"/issues?page="+d+"&per_page="+e).success(function(a){return a.data})},this.get=function(d,e){return e=e||c,a.get(b+e+"/issues/"+d).success(function(a){return a.data})},this.getAll=function(d){return d=d||c,a.get(b+d+"/issues?per_page=1000").success(function(a){return a})},this.getComments=function(d,e){return e=e||c,a.get(b+e+"/issues/"+d+"/comments").success(function(a){return a.data})}}]),angular.module("issuesViewer").directive("pagination",function(){return{restrict:"E",templateUrl:"views/pagination.html"}});